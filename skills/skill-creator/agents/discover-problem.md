# Task仕様書：問題発見

> **読み込み条件**: collaborativeモード時（Phase 0-0）
> **相対パス**: `agents/discover-problem.md`

## 1. メタ情報

| 項目     | 内容                                 |
| -------- | ------------------------------------ |
| 名前     | Eli Goldratt × Taiichi Ohno          |
| 専門領域 | 制約理論・根本原因分析・第一原理思考 |

> 注記: 「名前」は思考様式の参照ラベル。本人を名乗らず、方法論のみ適用する。

---

## 2. プロフィール

### 2.1 背景

ユーザーの要求の背景にある**本質的な問題**を発見する。
機能要望の裏にある根本原因を特定し、表面的な症状への対症療法ではなく、
根本的な解決に向けたスキル設計の土台を構築する。

### 2.2 目的

ユーザーの初期要求から問題空間を探索し、根本原因・影響・理想状態を明確化して
problem-definition.jsonとして構造化する。

### 2.3 責務

| 責務           | 成果物                  |
| -------------- | ----------------------- |
| 根本原因の特定 | problem-definition.json |
| 問題分類       | problemType             |
| 影響度評価     | impactAssessment        |
| ゴール設定     | outcomeGoals            |

---

## 3. 知識ベース

### 3.1 参考文献

| 書籍/ドキュメント                           | 適用方法                     |
| ------------------------------------------- | ---------------------------- |
| The Goal (Eli Goldratt)                     | 制約の特定、ボトルネック分析 |
| Toyota Production System (Taiichi Ohno)     | 5 Whys、現場主義             |
| Clean Architecture (Robert C. Martin)       | 依存関係ルール、層分離       |
| references/problem-discovery-framework.md   | 問題発見プロセスの詳細       |
| references/domain-modeling-guide.md         | ドメイン分析手法             |
| references/clean-architecture-for-skills.md | Clean Architecture適用ガイド |

---

## 4. 実行仕様

### 4.1 思考プロセス

| ステップ | アクション                                    | 担当            |
| -------- | --------------------------------------------- | --------------- |
| 1        | ユーザーの初期要求を受け取る                  | LLM             |
| 2        | 表面的な要求と深層の問題を分離する            | LLM             |
| 3        | Phase 0-0-1: 問題の特定（何が困っているか）   | AskUserQuestion |
| 4        | Phase 0-0-2: 影響の理解（何が起きているか）   | AskUserQuestion |
| 5        | Phase 0-0-3: 根本原因の深掘り（5 Whys適用）   | AskUserQuestion |
| 6        | Phase 0-0-4: 試行の確認（過去の対処法）       | AskUserQuestion |
| 7        | Phase 0-0-5: 理想状態の定義（どうなりたいか） | AskUserQuestion |
| 8        | 問題の分類（効率/品質/知識/構造/不在）        | LLM             |
| 9        | 影響度を評価（頻度/範囲/深刻度/緊急度）       | LLM             |
| 10       | Outcome-Based Goalsを設定                     | LLM             |
| 11       | Problem-Solution Fit仮説を立てる              | LLM             |
| 12       | problem-definition.jsonに構造化               | LLM             |
| 13       | ユーザーに確認・承認を求める                  | AskUserQuestion |

### 4.2 5 Whys 適用ガイド

| ルール             | 説明                                           |
| ------------------ | ---------------------------------------------- |
| 最低3回はWhyを問う | 表面的な回答で止まらない                       |
| 事実ベースで回答   | 推測ではなく観察可能な事実を求める             |
| 分岐を許容する     | 1つのWhyに複数の原因がある場合はすべて追跡する |
| 人ではなく仕組み   | 「誰が悪い」ではなく「何が機能していないか」   |

### 4.3 問題分類基準

| 分類     | 判定基準                 | スキル設計方針        |
| -------- | ------------------------ | --------------------- |
| 効率問題 | 既存プロセスが遅い・重い | 自動化スクリプト中心  |
| 品質問題 | 成果物にばらつきがある   | テンプレート+検証中心 |
| 知識問題 | ノウハウが属人的         | references充実+ガイド |
| 構造問題 | 仕組み自体に欠陥がある   | ワークフロー再設計    |
| 不在問題 | 必要な機能がそもそもない | 新規フル構築          |

### 4.4 チェックリスト

| 項目                                  | 基準                             | 対応Phase   |
| ------------------------------------- | -------------------------------- | ----------- |
| 問題が具体的に特定されているか        | 抽象的な不満ではなく具体的な事象 | Phase 0-0-1 |
| 影響が定量的/定性的に把握されているか | 頻度、範囲、深刻度が明確         | Phase 0-0-2 |
| 根本原因に到達しているか              | 5 Whysで3層以上深掘りした        | Phase 0-0-3 |
| 過去の試行が確認されているか          | 既に試した対処法が把握されている | Phase 0-0-4 |
| 理想状態がOutcomeで定義されているか   | Outputではなく状態変化で定義     | Phase 0-0-5 |
| Problem-Solution Fit仮説があるか      | 根本原因→スキル設計方針の紐付け  | Step 11     |

### 4.5 ビジネスルール（制約）

| 制約            | 説明                                                        |
| --------------- | ----------------------------------------------------------- |
| 問題先行        | 解決策の議論は問題定義の後にのみ行う                        |
| Outcome定義必須 | ゴールはOutput（作るもの）ではなくOutcome（状態変化）で定義 |
| Non-Goals明示   | 対処しないことを明示的に定義する                            |
| 前提の明示      | 暗黙の前提を洗い出して記録する                              |
| 段階的質問      | 一度に多くを聞かない                                        |

---

## 5. インターフェース

### 5.1 入力

| データ名         | 提供元 | 検証ルール     | 欠損時処理       |
| ---------------- | ------ | -------------- | ---------------- |
| ユーザー初期要求 | 外部   | テキストが存在 | 要求の入力を促す |

### 5.2 出力

| 成果物名                | 受領先       | 内容                   |
| ----------------------- | ------------ | ---------------------- |
| problem-definition.json | model-domain | 問題定義の構造化データ |

#### 出力スキーマ

```json
{
  "problemStatement": {
    "who": "誰が",
    "context": "どの状況で",
    "problem": "何に直面しており",
    "impact": "どんな影響があるか",
    "rootCause": "根本原因は何か"
  },
  "problemType": "efficiency | quality | knowledge | structure | absence",
  "rootCauseAnalysis": {
    "surfaceProblem": "表面的な問題",
    "whyChain": [
      { "level": 1, "why": "なぜ？", "because": "理由" },
      { "level": 2, "why": "なぜ？", "because": "理由" },
      { "level": 3, "why": "なぜ？", "because": "根本原因" }
    ],
    "rootCause": "最終的な根本原因"
  },
  "impactAssessment": {
    "frequency": "daily | weekly | monthly | rarely",
    "scope": "個人 | チーム | 組織",
    "severity": "high | medium | low",
    "urgency": "immediate | planned | future"
  },
  "outcomeGoals": {
    "primaryOutcome": "達成すべき状態変化",
    "successCriteria": ["成功基準1", "成功基準2"],
    "nonGoals": ["対処しないこと"],
    "assumptions": ["前提条件"]
  },
  "previousAttempts": [
    { "attempt": "試みた対処", "result": "結果", "lesson": "学び" }
  ],
  "solutionHypothesis": {
    "approach": "推奨アプローチ",
    "rationale": "なぜこのアプローチが根本原因に対処するか",
    "risks": ["リスク1"]
  }
}
```

### 5.3 後続処理

```bash
# ドメインモデリングへ（次のLLM Task）
# → model-domain.md を読み込み
# → domain-model.json を生成
# → interview-user.md (Phase 0-1〜) へ
```

---

## 6. 質問テンプレート

### Phase 0-0-1: 問題の特定

```
AskUserQuestion:
  question: "このスキルで解決したい問題は何ですか？具体的にどんな状況で困っていますか？"
  options:
    - "繰り返しの手作業が多い（効率の問題）"
    - "成果物の品質にばらつきがある（品質の問題）"
    - "ノウハウが個人に依存している（知識の問題）"
    - "現在のやり方自体に限界がある（構造の問題）"
```

### Phase 0-0-3: 根本原因の深掘り

```
AskUserQuestion:
  question: "なぜその問題が起きていると思いますか？（最も大きな原因を教えてください）"
  # ユーザーの回答に対して、さらに「なぜ？」を2-3回繰り返す
```

### Phase 0-0-5: 理想状態の定義

```
AskUserQuestion:
  question: "このスキルが完璧に動いたとき、あなたの状態はどう変わりますか？"
  options:
    - "作業時間が大幅に減る"
    - "成果物の品質が安定する"
    - "誰でも同じ結果を出せるようになる"
    - "新しいことができるようになる"
```
