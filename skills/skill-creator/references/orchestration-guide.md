# ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¬ã‚¤ãƒ‰

> **èª­ã¿è¾¼ã¿æ¡ä»¶**: ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ä½¿ç”¨æ™‚
> **ç›¸å¯¾ãƒ‘ã‚¹**: `references/orchestration-guide.md`

---

## æ¦‚è¦

ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€è¤‡æ•°ã®ã‚¹ã‚­ãƒ«ã‚’é€£æºã•ã›ã¦è¤‡é›‘ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿç¾ã™ã‚‹æ©Ÿèƒ½ã€‚

### ä¸»è¦æ©Ÿèƒ½

| æ©Ÿèƒ½                 | èª¬æ˜                       | ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹                  |
| -------------------- | -------------------------- | ----------------------------- |
| **ã‚¹ã‚­ãƒ«ãƒã‚§ãƒ¼ãƒ³**   | Aâ†’Bâ†’C ã®é€£é–å®Ÿè¡Œ           | ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³            |
| **ä¸¦åˆ—å®Ÿè¡Œ**         | è¤‡æ•°ã‚¹ã‚­ãƒ«ã®åŒæ™‚å®Ÿè¡Œ       | ãƒãƒƒãƒå‡¦ç†ã€ãƒãƒ«ãƒã‚½ãƒ¼ã‚¹å–å¾—  |
| **æ¡ä»¶åˆ†å²**         | å®Ÿè¡Œçµæœã«åŸºã¥ãåˆ†å²       | ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€A/Bãƒ•ãƒ­ãƒ¼ |
| **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°** | cronçš„ãªå®šæœŸå®Ÿè¡Œ           | å®šæ™‚ãƒãƒƒãƒã€ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ      |
| **ã‚¤ãƒ™ãƒ³ãƒˆãƒˆãƒªã‚¬ãƒ¼** | Webhook/ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã§èµ·å‹• | CI/CDã€ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–           |

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Orchestration Engine                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Trigger   â”‚  â”‚  Scheduler  â”‚  â”‚   Manual    â”‚         â”‚
â”‚  â”‚   Manager   â”‚  â”‚   Manager   â”‚  â”‚   Trigger   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚         â”‚                â”‚                â”‚                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                          â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   Flow Controller                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ â”‚
â”‚  â”‚  â”‚  Chain  â”‚  â”‚  Parallel   â”‚  â”‚ Conditional â”‚       â”‚ â”‚
â”‚  â”‚  â”‚ Executorâ”‚  â”‚  Executor   â”‚  â”‚  Evaluator  â”‚       â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          â”‚              â”‚                â”‚                 â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                         â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                  Skill Executor                        â”‚ â”‚
â”‚  â”‚     skill-a    skill-b    skill-c    skill-d          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚                                  â”‚
â”‚                         â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                  Context Store                         â”‚ â”‚
â”‚  â”‚   å…¥å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿ã€å®Ÿè¡ŒçŠ¶æ…‹ã€å…±æœ‰å¤‰æ•°ã‚’ç®¡ç†              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### å¤‰æ•°å‚ç…§æ§‹æ–‡

```yaml
# å‰ã‚¹ãƒ†ãƒƒãƒ—ã®å‡ºåŠ›ã‚’å‚ç…§
"{{step1.output}}"
"{{step1.output.data.items[0].name}}"

# ãƒˆãƒªã‚¬ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å‚ç…§
"{{trigger.data}}"
"{{trigger.headers.authorization}}"

# ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå¤‰æ•°ã‚’å‚ç…§
"{{context.api_key}}"
"{{context.config.timeout}}"

# ç’°å¢ƒå¤‰æ•°ã‚’å‚ç…§
"{{env.API_KEY}}"
"{{env.DATABASE_URL}}"

# çµ„ã¿è¾¼ã¿å¤‰æ•°
"{{$timestamp}}"      # ISO8601å½¢å¼ã®ç¾åœ¨æ™‚åˆ»
"{{$date}}"           # YYYY-MM-DDå½¢å¼
"{{$uuid}}"           # UUID v4
"{{$random}}"         # 0-1ã®ãƒ©ãƒ³ãƒ€ãƒ æ•°
```

### ãƒãƒƒãƒ”ãƒ³ã‚°ä¾‹

```yaml
flow:
  - id: fetch-data
    skill: api-client
    args:
      url: "https://api.example.com/data"
      headers:
        Authorization: "Bearer {{env.API_TOKEN}}"

  - id: transform
    skill: data-transformer
    args:
      input: "{{fetch-data.output.body}}"
      format: "csv"
    depends_on: [fetch-data]

  - id: upload
    skill: file-uploader
    args:
      data: "{{transform.output}}"
      filename: "report-{{$date}}.csv"
    depends_on: [transform]
```

---

## å®Ÿè¡Œãƒ¢ãƒ‡ãƒ«

ğŸ“– ãƒ‘ã‚¿ãƒ¼ãƒ³è©³ç´°: [workflow-patterns.md](workflow-patterns.md)

| ãƒ‘ã‚¿ãƒ¼ãƒ³       | è¨˜æ³•   | ç‰¹å¾´                   |
| -------------- | ------ | ---------------------- |
| ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ« | `â†’`    | é †æ¬¡å®Ÿè¡Œã€ä¾å­˜é–¢ä¿‚ã‚ã‚Š |
| ãƒ‘ãƒ©ãƒ¬ãƒ«       | `âˆ¥`    | åŒæ™‚å®Ÿè¡Œã€çµæœé›†ç´„     |
| æ¡ä»¶åˆ†å²       | `â—‡`    | æ¡ä»¶å¼ã§åˆ†å²           |
| ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰   | çµ„åˆã› | ä¸Šè¨˜ã‚’çµ„ã¿åˆã‚ã›       |

---

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### æˆ¦ç•¥

| æˆ¦ç•¥       | èª¬æ˜                   | ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹         |
| ---------- | ---------------------- | -------------------- |
| `abort`    | å³åº§ã«å…¨ä½“ã‚’åœæ­¢       | ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãªã‚¨ãƒ©ãƒ¼ |
| `retry`    | æŒ‡å®šå›æ•°ãƒªãƒˆãƒ©ã‚¤       | ä¸€æ™‚çš„ãªéšœå®³         |
| `skip`     | ãã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’ã‚¹ã‚­ãƒƒãƒ— | ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ãªå‡¦ç†   |
| `fallback` | ä»£æ›¿ã‚¹ã‚­ãƒ«ã‚’å®Ÿè¡Œ       | å†—é•·æ€§ç¢ºä¿           |

### ãƒªãƒˆãƒ©ã‚¤è¨­å®š

```yaml
retry:
  count: 3
  delay: 5 # ç§’
  backoff: exponential # fixed | exponential
  # exponentialã®å ´åˆ: 5s â†’ 10s â†’ 20s
```

### ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯

```yaml
on_error:
  strategy: fallback
  fallback_skill: error-handler
  # error-handlerã«ã¯ä»¥ä¸‹ãŒæ¸¡ã•ã‚Œã‚‹:
  # - error: ã‚¨ãƒ©ãƒ¼è©³ç´°
  # - failed_step: å¤±æ•—ã—ãŸã‚¹ãƒ†ãƒƒãƒ—ID
  # - context: ãã‚Œã¾ã§ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
```

---

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. å†ªç­‰æ€§ã‚’ç¢ºä¿

```yaml
# è‰¯ã„ä¾‹: åŒã˜å…¥åŠ›ãªã‚‰åŒã˜çµæœ
- id: create-or-update
  skill: database-upsert
  args:
    key: "{{input.id}}"
    data: "{{input.data}}"

# æ‚ªã„ä¾‹: å®Ÿè¡Œã®ãŸã³ã«çµæœãŒå¤‰ã‚ã‚‹
- id: create
  skill: database-insert
  args:
    data: "{{input.data}}"
```

### 2. ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’è¨­å®š

```yaml
flow:
  - id: external-api
    skill: api-client
    timeout: 30 # ç§’
    # å¤–éƒ¨APIå‘¼ã³å‡ºã—ã¯å¿…ãšã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š
```

### 3. é©åˆ‡ãªç²’åº¦

```yaml
# è‰¯ã„ä¾‹: è²¬å‹™ãŒæ˜ç¢º
- id: fetch
  skill: data-fetcher
- id: transform
  skill: data-transformer
- id: save
  skill: data-saver

# æ‚ªã„ä¾‹: 1ã‚¹ãƒ†ãƒƒãƒ—ã§å…¨éƒ¨ã‚„ã‚‹
- id: do-everything
  skill: mega-processor
```

### 4. ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’æ´»ç”¨

```yaml
context:
  api_base_url: "https://api.example.com"
  batch_size: 100
  retry_count: 3

flow:
  - id: step1
    args:
      url: "{{context.api_base_url}}/endpoint"
```

---

## é–¢é€£ãƒªã‚½ãƒ¼ã‚¹

| ãƒªã‚½ãƒ¼ã‚¹                                                    | ç”¨é€”                 |
| ----------------------------------------------------------- | -------------------- |
| [skill-chain-patterns.md](skill-chain-patterns.md)          | ãƒã‚§ãƒ¼ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³é›†   |
| [parallel-execution-guide.md](parallel-execution-guide.md)  | ä¸¦åˆ—å®Ÿè¡Œè©³ç´°         |
| [scheduler-guide.md](scheduler-guide.md)                    | ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼è¨­å®š   |
| [event-trigger-guide.md](event-trigger-guide.md)            | ã‚¤ãƒ™ãƒ³ãƒˆãƒˆãƒªã‚¬ãƒ¼è¨­å®š |
| [schemas/orchestration.json](../schemas/orchestration.json) | ã‚¹ã‚­ãƒ¼ãƒå®šç¾©         |
