{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/google-forms-generator/question.json",
  "title": "質問スキーマ",
  "description": "Google Forms APIの質問定義スキーマ",
  "type": "object",
  "required": ["title", "type"],
  "properties": {
    "title": {
      "type": "string",
      "description": "質問文",
      "minLength": 1,
      "maxLength": 1000
    },
    "type": {
      "type": "string",
      "description": "質問タイプ",
      "enum": [
        "SHORT_TEXT",
        "LONG_TEXT",
        "RADIO",
        "CHECKBOX",
        "DROP_DOWN",
        "SCALE",
        "GRID_RADIO",
        "GRID_CHECKBOX",
        "DATE",
        "TIME",
        "RATING"
      ]
    },
    "required": {
      "type": "boolean",
      "description": "必須回答かどうか",
      "default": false
    },
    "description": {
      "type": "string",
      "description": "質問の補足説明"
    }
  },
  "allOf": [
    {
      "if": {
        "properties": {
          "type": { "enum": ["SHORT_TEXT", "LONG_TEXT"] }
        }
      },
      "then": {
        "properties": {
          "grading": {
            "description": "採点設定（クイズモード、SHORT_TEXTのみ自動採点可能）",
            "type": "object"
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "type": { "enum": ["RADIO", "CHECKBOX", "DROP_DOWN"] }
        }
      },
      "then": {
        "required": ["options"],
        "properties": {
          "options": {
            "type": "array",
            "description": "選択肢",
            "minItems": 1,
            "maxItems": 200,
            "items": {
              "oneOf": [
                { "type": "string" },
                {
                  "type": "object",
                  "required": ["value"],
                  "properties": {
                    "value": { "type": "string" },
                    "goToAction": {
                      "type": "string",
                      "enum": ["NEXT_SECTION", "RESTART_FORM", "SUBMIT_FORM"]
                    },
                    "goToSectionId": { "type": "string" }
                  }
                }
              ]
            }
          },
          "hasOther": {
            "type": "boolean",
            "description": "「その他」オプションを追加（DROP_DOWNでは使用不可）",
            "default": false
          },
          "shuffle": {
            "type": "boolean",
            "description": "選択肢をランダム表示",
            "default": false
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "type": { "const": "SCALE" }
        }
      },
      "then": {
        "properties": {
          "low": {
            "type": "integer",
            "description": "スケールの最小値",
            "minimum": 0,
            "maximum": 1,
            "default": 1
          },
          "high": {
            "type": "integer",
            "description": "スケールの最大値",
            "minimum": 2,
            "maximum": 10,
            "default": 5
          },
          "lowLabel": {
            "type": "string",
            "description": "最小値のラベル"
          },
          "highLabel": {
            "type": "string",
            "description": "最大値のラベル"
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "type": { "const": "RATING" }
        }
      },
      "then": {
        "properties": {
          "ratingScaleLevel": {
            "type": "integer",
            "description": "評価段階数",
            "minimum": 3,
            "maximum": 10,
            "default": 5
          },
          "iconType": {
            "type": "string",
            "description": "評価アイコンの種類",
            "enum": ["STAR", "HEART", "THUMB_UP"],
            "default": "STAR"
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "type": { "enum": ["GRID_RADIO", "GRID_CHECKBOX"] }
        }
      },
      "then": {
        "required": ["rows", "columns"],
        "properties": {
          "rows": {
            "type": "array",
            "description": "グリッドの行（質問項目）",
            "minItems": 1,
            "items": { "type": "string" }
          },
          "columns": {
            "type": "array",
            "description": "グリッドの列（選択肢）",
            "minItems": 1,
            "items": { "type": "string" }
          },
          "shuffleQuestions": {
            "type": "boolean",
            "description": "行をランダム表示",
            "default": false
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "type": { "const": "DATE" }
        }
      },
      "then": {
        "properties": {
          "includeYear": {
            "type": "boolean",
            "description": "年を含める",
            "default": true
          },
          "includeTime": {
            "type": "boolean",
            "description": "時刻入力も可能にする",
            "default": false
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "type": { "const": "TIME" }
        }
      },
      "then": {
        "properties": {
          "duration": {
            "type": "boolean",
            "description": "経過時間モードにする",
            "default": false
          }
        }
      }
    }
  ],
  "examples": [
    {
      "title": "お名前を入力してください",
      "type": "SHORT_TEXT",
      "required": true
    },
    {
      "title": "性別を選択してください",
      "type": "RADIO",
      "required": true,
      "options": ["男性", "女性", "回答しない"]
    },
    {
      "title": "満足度を評価してください",
      "type": "SCALE",
      "required": true,
      "low": 1,
      "high": 5,
      "lowLabel": "不満",
      "highLabel": "満足"
    }
  ]
}
